/*
Common Packers Yara Rule
Developed by KrknSec
*/

rule mpress_v2_19 : Packer
{
	meta:
			author="Krkn Security"
			date_create="2/17/2021"
			description="Mpress Packer v2.19"

	strings:
		$x={6D 70 72 65 73 73}
		$y={0D 4D 00 50 00 52 00 45 00 53 00 53 00}
		$z={21 46 00 69 00 6C 00 65 00 20 00 69 00 73 00 20 00 69 00 6E 00 76 00 61 00 6C 00 69 00 64 00 2E 00 00}

	condition:
		($x and $y and $z) or ($y and $z) or ($x and $y) or ($x and $z)
}

rule upx_v3_96 : Packer
{
	meta:
			author="Krkn Security"
			date_create="2/17/2021"
			description="UPX Packer v3.96"

	strings:
		$x={55 50 58 30}
		$y={55 50 58 31}
		$z={55 50 58 21}

	condition:
		($x and $y and $z) or ($y and $z) or ($x and $y) or ($x and $z)
}

rule MEW_Packed : Packer
{
	meta:
			author="Krkn Security"
			date_create="2/17/2021"
			description="MEW Packer"

	strings:
		$x={4D 45 57}
		$y={50 72 6F 63 41 64 64 72 65 73 73}

	condition:
		$x and $y
}

rule PECompact2 : Packer
{
	meta:
			author="Krkn Security"
			date_create="2/17/2021"
			description="PECompact Packer"

	strings:
		$x={50 45 43 6F 6D 70 61 63 74 32}
		$y={50 45 43 32 54 4F}
		$z={74 65 78 74 62 73 73}

	condition:
		($x and $y and $z) or ($y and $z) or ($x and $y) or ($x and $z)
}

rule VMProtect : Packer
{
	meta:
			author="Krkn Security"
			date_create="2/17/2021"
			description="VMProtect Packer"

	strings:
		$x={30 30 63 66 67}
		$y={41 64 53 30}
		$z={41 64 53 31}

	condition:
		($x and $y and $z) or ($y and $z) or ($x and $y) or ($x and $z)
}

rule ASPack : Packer
{
	meta:
			author="Krkn Security"
			date_create="2/17/2021"
			description="ASPack Packer"

	strings:
		$x={61 73 70 61 63 6B}
		$y={56 69 72 74 75 61 6C 46 72 65 65}
		$z={4C 4F 41 44 45 52 20 45 52 52 4F 52}

	condition:
		($x and $y and $z)
}

rule Themida : Packer
{
	meta:
			author="Krkn Security"
			date_create="2/17/2021"
			description="Themida Packer"

	strings:
		$x={74 68 65 6D 69 64 61}
		$y={62 6F 6F 74}
		$z={47 65 74 4D 6F 64 75 6C 65 48 61 6E 64 6C 65 41}

	condition:
		($x and $y and $z) or ($y and $z) or ($x and $y) or ($x and $z)
}

rule PELock : Packer
{
	meta:
			author="Krkn Security"
			date_create="2/17/2021"
			description="PELock Packer"

	strings:
		$x={74 65 78 74 31}
		$y={62 73 73}
		$z={00 8B C7 E8 C4 01 00 00 89 65 E8 8B F4 89 3E 56}

	condition:
		($x and $y and $z) or ($y and $z) or ($x and $y) or ($x and $z)
}

rule WinRarSFXArchive : Packer
{
	meta:
			author="Krkn Security"
			date_create="2/17/2021"
			description="WinRAR SFX Archive"

	strings:
		$x={00 73 00 66 00 78 00}
		$y={00 73 00 66 00 78 00 63 00 6D 00 64 00}
		$z={43 72 79 70 74 50 72 6F 74 65 63 74 4D 65 6D 6F 72 79}

	condition:
		($x and $y and $z)
}